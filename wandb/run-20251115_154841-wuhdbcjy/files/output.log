[ckpt] Loading checkpoint from best_model.pt ...
[ckpt] Loaded model_state
[ckpt] Loaded optim_state
[ckpt] Loaded scheduler_state
[ckpt] Resuming from step 500
train:   2%|██▌                                                                                                     | 500/20000 [00:00<?, ?step/s]/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/site-packages/torch/nn/functional.py:6044: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
Starting epoch 1/100
  warnings.warn(
                                                                                                                                                  
[valid 1000] EM=0.098 TES=0.321
New best EM=0.098 at step 1000; saved to best_model.pt
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 10005
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 63509
  [2] ERR | input: 28 | target: 28 | pred: 128
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 1100009
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 100000
[valid 1500] EM=0.151 TES=0.397
New best EM=0.151 at step 1500; saved to best_model.pt
Sample validation output:
  [0] OK | input: 97725 | target: 97725 | pred: 97725
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 63000
  [2] ERR | input: 28 | target: 28 | pred: 288
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 100009
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 1099
[valid 2000] EM=0.246 TES=0.517
New best EM=0.246 at step 2000; saved to best_model.pt
Sample validation output:
  [0] OK | input: 97725 | target: 97725 | pred: 97725
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 63802
  [2] ERR | input: 28 | target: 28 | pred: 288
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 101081
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 100005
Starting epoch 2/100
[valid 2500] EM=0.246 TES=0.504
Sample validation output:
  [0] OK | input: 97725 | target: 97725 | pred: 97725
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 69132
  [2] ERR | input: 28 | target: 28 | pred: 288
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 110333
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 10000
[valid 3000] EM=0.097 TES=0.373
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 970005
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 63142
  [2] ERR | input: 28 | target: 28 | pred: 288
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 1100000
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 100000
[valid 3500] EM=0.138 TES=0.386
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 97625
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 100642
  [2] ERR | input: 28 | target: 28 | pred: 224
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 106662
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 166640
[valid 4000] EM=0.109 TES=0.414
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 977275
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 66042
  [2] ERR | input: 28 | target: 28 | pred: 1666
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 227777
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 98272
Starting epoch 3/100
[valid 4500] EM=0.120 TES=0.462
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 97732
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 66052
  [2] ERR | input: 28 | target: 28 | pred: 2802
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 100423
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 1922223
[valid 5000] EM=0.139 TES=0.446
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 108835
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 70542
  [2] ERR | input: 28 | target: 28 | pred: 240
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 33333
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 53333333
[valid 5500] EM=0.199 TES=0.541
Sample validation output:
  [0] OK | input: 97725 | target: 97725 | pred: 97725
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 26
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 50112
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 98117
[valid 6000] EM=0.160 TES=0.505
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 977255
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 70042
  [2] ERR | input: 28 | target: 28 | pred: 640
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 217877
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6777777
Starting epoch 4/100
[valid 6500] EM=0.258 TES=0.567
New best EM=0.258 at step 6500; saved to best_model.pt
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 98825
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 70542
  [2] ERR | input: 28 | target: 28 | pred: 64
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 30444
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 104822
[valid 7000] EM=0.131 TES=0.422
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 98775
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 646
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 390000
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 509000
[valid 7500] EM=0.233 TES=0.575
Sample validation output:
  [0] OK | input: 97725 | target: 97725 | pred: 97725
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 56
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 261006
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6111117
[valid 8000] EM=0.232 TES=0.594
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 977255
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 50
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 30052
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 7925527
Starting epoch 5/100
[valid 8500] EM=0.134 TES=0.399
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1073870
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 65042
  [2] ERR | input: 28 | target: 28 | pred: 616
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 339998
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 59113997
[valid 9000] EM=0.187 TES=0.499
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 107885
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 66
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 310032
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 560555
[valid 9500] EM=0.144 TES=0.437
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 988585
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 50
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 250038
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 55005555
[valid 10000] EM=0.226 TES=0.530
Sample validation output:
  [0] OK | input: 97725 | target: 97725 | pred: 97725
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67542
  [2] ERR | input: 28 | target: 28 | pred: 66
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 102272
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 622262
Starting epoch 6/100
[valid 10500] EM=0.184 TES=0.496
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1075375
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 286
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 50038
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 650000
[valid 11000] EM=0.159 TES=0.446
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 107775
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 66
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 41176
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6711799
[valid 11500] EM=0.221 TES=0.532
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 98835
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 62
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 357976
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6515779
[valid 12000] EM=0.293 TES=0.576
New best EM=0.293 at step 12000; saved to best_model.pt
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 98735
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 76
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 111136
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 5701775
Starting epoch 7/100
[valid 12500] EM=0.262 TES=0.558
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 98886
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 66
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 368034
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 576165
[valid 13000] EM=0.165 TES=0.455
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1078815
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67052
  [2] ERR | input: 28 | target: 28 | pred: 66
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 319936
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 5966669
[valid 13500] EM=0.177 TES=0.471
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 107885
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67053
  [2] ERR | input: 28 | target: 28 | pred: 60
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 366076
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 5666665
[valid 14000] EM=0.235 TES=0.536
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 988555
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 50
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 366142
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 5016665
Starting epoch 8/100
[valid 14500] EM=0.218 TES=0.508
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 107885
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67042
  [2] ERR | input: 28 | target: 28 | pred: 66
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 318126
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 58655655
[valid 15000] EM=0.187 TES=0.467
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 107785
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67043
  [2] ERR | input: 28 | target: 28 | pred: 50
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 399062
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6766607
[valid 15500] EM=0.157 TES=0.448
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1078876
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67048
  [2] ERR | input: 28 | target: 28 | pred: 60
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 390066
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 5966666
[valid 16000] EM=0.190 TES=0.491
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 108885
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67043
  [2] ERR | input: 28 | target: 28 | pred: 51
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 41096
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6966661
Starting epoch 9/100
[valid 16500] EM=0.164 TES=0.463
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1078866
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67043
  [2] ERR | input: 28 | target: 28 | pred: 60
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 36856
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6966665
[valid 17000] EM=0.162 TES=0.465
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1078816
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67048
  [2] ERR | input: 28 | target: 28 | pred: 50
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 39996
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6966665
[valid 17500] EM=0.170 TES=0.464
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1078866
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67048
  [2] ERR | input: 28 | target: 28 | pred: 60
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 390966
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6866665
[valid 18000] EM=0.184 TES=0.477
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 107886
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67043
  [2] ERR | input: 28 | target: 28 | pred: 60
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 49066
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6866668
Starting epoch 10/100
[valid 18500] EM=0.177 TES=0.476
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1078866
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67048
  [2] ERR | input: 28 | target: 28 | pred: 60
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 398966
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6866665
[valid 19000] EM=0.184 TES=0.469
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1078866
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67048
  [2] ERR | input: 28 | target: 28 | pred: 60
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 49066
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6866665
[valid 19500] EM=0.185 TES=0.473
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1078865
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67048
  [2] ERR | input: 28 | target: 28 | pred: 60
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 49066
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6866665
[valid 20000] EM=0.186 TES=0.473
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 1078865
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 67048
  [2] ERR | input: 28 | target: 28 | pred: 60
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 49066
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 6866665
Saved model.pt
