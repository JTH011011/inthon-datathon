[ckpt] No checkpoint found at best_model.pt, starting from scratch.
train:   0%|                                                                                         | 0/20000 [00:00<?, ?step/s]/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/site-packages/torch/utils/data/dataloader.py:692: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, device pinned memory won't be used.
Starting epoch 1/100
  warnings.warn(warn_msg)
/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/site-packages/torch/nn/functional.py:6044: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
train:   2%|█▉                                                                           | 500/20000 [05:53<3:44:48,  1.45step/s]/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/site-packages/torch/nn/modules/transformer.py:515: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/aten/src/ATen/NestedTensorImpl.cpp:182.)
  output = torch._nested_tensor_from_mask(
train:   8%|████▏                                                  | 1500/20000 [18:38<3:34:00,  1.44step/s, EM=0.256, TES=0.517]Traceback (most recent call last):
[valid 500] EM=0.306 TES=0.525
New best EM=0.306 at step 500; saved to best_model.pt
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 9725
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 15159
  [2] OK | input: 28 | target: 28 | pred: 28
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 11195
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 11959
[valid 1000] EM=0.256 TES=0.517
Sample validation output:
  [0] ERR | input: 97725 | target: 97725 | pred: 97255
  [1] ERR | input: 3335+637207 | target: 640542 | pred: 73000
  [2] ERR | input: 28 | target: 28 | pred: 2836
  [3] ERR | input: 26803+9*34741 | target: 339472 | pred: 100006
  [4] ERR | input: 617878//698+980538*75 | target: 73541235 | pred: 100006
  File "/Users/taeheejeong/Desktop/inthon-dataton/train.py", line 335, in <module>
    )
  File "/Users/taeheejeong/Desktop/inthon-dataton/train.py", line 316, in main
  File "/Users/taeheejeong/Desktop/inthon-dataton/train.py", line 168, in train_loop
    for val_batch in val_dataloader:
  File "/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
  File "/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1470, in _next_data
    self._shutdown_workers()
  File "/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1618, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
  File "/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/opt/homebrew/Caskroom/miniconda/base/envs/inthon/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
